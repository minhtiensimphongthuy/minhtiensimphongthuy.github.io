<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Xuất Excel từ JSON</title>

  <!-- SheetJS (xlsx) từ CDN -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js" defer></script>
  <!-- file xử lý chính -->
  <script src="excel.js" defer></script>

  <style>
    body{font-family:Arial,Helvetica,sans-serif;padding:18px;background:#f6f6f6;color:#222}
    .box{max-width:900px;margin:14px auto;background:#fff;border-radius:6px;padding:16px;box-shadow:0 2px 8px rgba(0,0,0,0.06)}
    h2{margin:0 0 12px 0}
    label{display:block;margin:8px 0 6px}
    select,input{padding:8px 10px;border:1px solid #ddd;border-radius:4px;font-size:14px}
    button{background:#f5b400;border:0;padding:8px 12px;border-radius:6px;font-weight:700;cursor:pointer}
    button[disabled]{opacity:.5;cursor:default}
    #msg{margin-top:12px;color:#333;font-size:14px}
    .muted{color:#666;font-size:13px}
    .small{font-size:13px;color:#444;margin-top:8px}
  </style>
</head>
<body>
  <div class="box">
    <h2>Xuất file Excel từ dữ liệu JSON</h2>

    <p class="muted">Đặt file JSON (ví dụ: <code>data.json</code>, <code>data1.json</code>) cùng thư mục với <code>excel.html</code>.</p>

    <label for="dataFile">Chọn file JSON có sẵn trên site</label>
    <select id="dataFile"><option>Đang kiểm tra...</option></select>

    <div style="margin-top:12px;">
      <button id="btnDownload">Tải Excel</button>
      <button id="btnRefresh" style="margin-left:8px">Cập nhật danh sách file</button>
    </div>

    <div id="msg"></div>

    <p class="small">Ghi chú: nếu bạn muốn thêm nhiều file JSON, upload chúng vào repository (cùng folder) rồi nhấn "Cập nhật danh sách file".</p>
  </div>
</body>
</html>
